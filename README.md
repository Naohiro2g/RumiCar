# RumiCar

Please check a type of Computer Module (CM) and programming languages. If you use Arduino Nano or ESP32, please go to an "ArduinoAndESP32" folder. If you use Raspberry Pi Zero W, please go to a "RasPi" folder. Python is used for programs in "RasPi."

コンピュータモジュールの種類によりプログラムや使用コンピュータ言語が異なります。

Arduino Nano と ESP32 の場合はフォルダArduinoAndESP32をお使いください。
Raspberry Pi Zero W の場合はフォルダRasPiをお使いください。Raspiはコンピュータ言語はPythonです。

### フォルダの説明

- **ArduinoAndESP32フォルダ**<br>　RumiCarのコンピュータモジュールのArduino Nano版とESP32版用のサンプルプルプグラムです。<br>ハンズオンで使用するプログラムが保存されています。RumiCarハンズ用の資料はフォルダ「**ハンズオン用テキスト**」の下に保存されていますのでまずそちらを参照ください。**ハンズオン用テキストはPDF形式で約１０MBほどのファイルサイズです。GitHubから直接参照しようとすると表示できないことがあるようです。一旦ダウンロードしていただいてからご覧ください。**RumiCarをお持ちの方は以下のホルダにある各サンプルプログラムをRumICarにロードしてお楽しみください。

  - **Exercise-1　距離を測ってみよう！**<br>　RumiCarでは車体の前方に3個のレーザー測距モジュールを搭載しています。レーザー測距モジュールは人体に無害のレーザー光線を対象物に当て、その反射が戻ってくるまでの***時間***を計測することによって距離を測定します。音速はマッハと呼ばれ時速1000km以上の速度ですが、光の速さはその音速の***88万倍***も速いです。その光が当たって帰ってくるまでの時間を計る、なんて凄いですね。
  
    - **Exercise-1.1 中央のセンサで測距しよう！**<br>　RumiCarに3個搭載されているレーザー測距モジュールのうちの一つ、中央のセンサーを使って距離を測ってみます。Arduino IDEのシリアルモニタを使って皆さんのパソコンに測定した距離をリアルタイムに表示します。センサの前に手をかざし、手を前後に動かすと手とセンサの間のが変わりますので表示される距離の値もリアルタイムに変化します。
    - **Exercise-1.2 3つのセンサで測距だ！**<br>　RumiCarに搭載されている3個のセンサを同時に動かしてみましょう。中央、左、右のそれぞれのセンサが測定した距離の値を同時にリアルタイムにパソコンの画面に表示します。それぞれのセンサの前に手をかざしてセンサの表示値が変化するのをお楽しみください。
    - **Exercise-1.3 シリアルプロッタを使ってみよう**<br>　Arduino IDEにはシリアルプロッタの機能もあります。これはデータを自動でグラフ表示してくれる機能です。プログラムはExercise-1.2と同じものを使いますが測定した距離値がリアルタイムに色分けされてグラフ化表示されます。Exercise-1.2と同じようにセンサの前に手をかざしてグラフが変化するか見てみましょう。どの色のグラフがどのセンサの値を表示しているか確かめましょう。
  - **Exercise-2 モータ制御**<br>　RumiCarはハンドルを曲げる時と走行する時にモータを使います。RumiCarではコンピュータモジュールのコンピュータがプログラムに従ってハンドルを動かしたりRumiCarが走るためにタイヤを回転させたりします。コンピュータモジュールを使ってRumiCarのモータを動かしてみましょう。
    - **Exercise-2.1 ハンドルを切る**<br>　RumiCarの前のタイヤを左右に動かしてみましょう。このプログラムではハンドルを左右に切ってそのまま0.5秒保持します。その動作を繰り返します。つまり、左に切って0.5秒、右に切って0.5秒、また左に切って0.5秒と、ずっと繰り返します。
    - **Exercise-2.2 速度制御**<br>　RumiCarの走る速度をコントロールしてみましょう。コンピュータモジュールからの命令によって走行用車輪、すなわち後ろのタイヤを回転させます。タイヤの回転速度を変化させることによりRumiCarの走るスピードを変化させることができます。ここではプログラムを使ってタイヤの回転速度を段階的に変化させます。モータの回転音が変わりますのでタイヤの回転を見るのと同時にモータの音の変化にも気をつけてみてください。
    - **Exercise-2.3 前進と後進**<br>　本物の自動車は前に進んだり後ろに下がったりします。RumiCarも同様に前進や後進ができます。プログラムを使ってRumiCarを前進させたり後進させたりしてみましょう。RumiCarを走らせる場所が無いときはRumiCarを手にしっかり持って後ろのタイヤが前進方向に回転したり、後進方向に回転するのを確認しましょう。
    - **Exercise-2.4 ジグザグ走行**<br> RumiCarをジグザグに走行させてみましょう。ハンドルを左右に切りながら前進します。RumiCarを走らせられる場所が無いときはRumiCarをしっかり手に持って期待通りの動きになっていることを確認しましょう。
  - **Exercise-3 自立走行基礎**<br>　自立走行の基礎としてセンサ等の情報を元に判断してRumiCarを制御してみます。前方の障害物や左右の壁などの距離を測定して、停止したり左右にハンドルを切りながらRumiCarを走行させてみます。
    - **Exercise-3.1 安全に停止する車**<br>　前方に障害物を発見して安全に停止する車を考えます。RumICarが直進中に前方に障害物を発見したら停止し、障害物が無くなったらまた走行再開します。障害物が近づいてきたら(?)、安全のために後進します。あなたの手を障害物と仮定してRumiCarがあなたの手にぶつからずに停止するか試してみましょう。RumICarが停止中にあなたの手をRumicarに近づけたら安全確保のためにRumiCarが後進しますか？
    - **Exercise-3.2 市街地を走る車**<br> この章では実際に走行コースを設置してRumiCarを走らせます。左右の壁や前方の障害物を検知しながらRumiCarが走行します。
- **ESP32フォルダ**<br>　RumiCarのコンピュータモジュールのうち、ESP32はWiFiやBlueToothなどの通信機能を内蔵しています。ここではESP32のBlueTooth機能を使ってRumiCarのセンサ測距値を無線で取得して表示させたり、RumiCarをワイヤレスで制御するサンプルプログラムが入っています。
     - **BLE**<BR> Bluetooth Low Energy(BLE)での通信。RumiCarのESP32版コンピュータモジュールに搭載されているBLEを使ってスマホ(iPhone)と通信してみました。3個の測距モジュールでの距離計測値をいPhoneのBLEScannerとのアプリで表示させています。 マルチコネクトが可能なので、個別の機器と接続や切断が不要ですので、例えば展示会などで来場者に各自のスマホからRumiCarに接続してもらって自分のスマホで計測値を表示させて楽しんで頂くことなどが可能です。
    - **Bluetooth**<br>Exercise-1.2はRumiCar　ESP32版用Bluetoothシリアル通信のサンプルプログラムです
  
  - Windos10とペアリング
    - 設定->デバイス->Bluetoothとその他のデバイス->Bluetoothまたはその他のデバイスを追加する->Bluetooth
    - RumiCar_ESP32を選択
    - デバイスマネージャー->ポート(COMとLPT)で"Bluetooth リンク経由の標準シリアル(COMn)"　を確認する"n"は数字　(2個表示される)
    - Arduino IDEの設定でツール->シリアルポート:　で、上記COMnに合わせる

  - ESP32が「ケーブルをつないでいない」のに測距値がシリアルモニタに表示できます
  - PC側からコマンドを送ってRumiCarをコントロールできます
  - サンプルプログラムはコマンド「r」、「l」、「f」、「b」に対応、それぞれ右、左、前進、後進を0.5秒実行します。コマンドは全て小文字です。 Arduino IDEのシリアルモニタの送信でコマンドを送ります
  - ケーブル接続が不要になりますので走行中に実際の測距データをPC側で取得したりPC側からコマンドを送ってラジコンのように操作したり、ができるようになります
- **RasPiフォルダ**<br>　RumiCarのコンピュータモジュールのラズパイ版のサンプルプログラムです。Pythonで記述されています。ラズパイ版コンピュータモジュールを使ってRumiCarを動かす場合にお使いください。
  - **Exercise-1　距離を測ってみよう！**
    - **Exercise-1.1 中央のセンサで測距しよう！**
    - **Exercise-1.2 3つのセンサで測距だ！**   
  - **Exercise-2 モータ制御**   
    - **Exercise-2.1 ハンドルを切る**    
    - **Exercise-2.2 速度制御**
    - **Exercise-2.3 前進と後進**
    - **Exercise-2.3 前進と後進**
    - **Exercise-2.4 ジグザグ走行**  
   - **Exercise-3 自立走行基礎**
     - **Exercise-3.1 安全に停止する車**   
     - **Exercise-3.2 市街地を走る車**
 - **ハンズオン用テキストフォルダ**<br>　RumiCarのハンズオン用テキストが保存されているフォルダです。RumiCarの歴史や仕組み、サンプルプログラムを使ってRumiCarをどうさせる方法や例が載っています。**ハンズオン用テキストはPDF形式で約１０MBほどのファイルサイズです。GitHubから直接参照しようとすると表示できないことがあるようです。一旦ダウンロードしていただいてからご覧ください。**
   
   
   
   
   
Slides (資料)：https://www.slideshare.net/ssuser4d5ccc/rumicar-handsonalgyan20200425202004242

Video about online RumiCar hands-on event (RumiCarハンズオン中継の録画)：https://youtu.be/99zH73B8NUo
